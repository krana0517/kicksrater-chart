<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé¨ ÏòÅÌôî Ï∂îÏ≤ú ÎåÄÏãúÎ≥¥Îìú</title>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, 'Helvetica Neue', 'Segoe UI', 'Apple SD Gothic Neo', 'Noto Sans KR', 'Malgun Gothic', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            animation: fadeInUp 0.8s ease-out;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            animation: fadeInUp 0.8s ease-out 0.2s both;
        }
        
        .api-section {
            background: #fff3cd;
            color: #856404;
            padding: 20px 40px;
            border-bottom: 1px solid #ffeaa7;
            text-align: center;
        }
        
        .api-input {
            display: flex;
            gap: 15px;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .api-input input {
            padding: 10px 15px;
            border: 2px solid #ffeaa7;
            border-radius: 8px;
            font-size: 0.9rem;
            min-width: 300px;
        }
        
        .api-input button {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .controls {
            padding: 30px 40px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }
        
        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .input-group input, .input-group select {
            flex: 1;
            min-width: 200px;
            padding: 15px 20px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.3s ease;
        }
        
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px 40px;
            background: white;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .stat-label {
            font-size: 1rem;
            color: #6c757d;
            font-weight: 500;
        }
        
        .movies {
            padding: 40px;
        }
        
        .movies h2 {
            font-size: 1.8rem;
            margin-bottom: 30px;
            color: #333;
        }
        
        .movie-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }
        
        .movie-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 1px solid #e9ecef;
        }
        
        .movie-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .movie-poster {
            width: 100%;
            height: 400px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
            position: relative;
            overflow: hidden;
        }
        
        .movie-poster img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .movie-poster .no-image {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .movie-rating {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .movie-info {
            padding: 25px;
        }
        
        .movie-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            line-height: 1.4;
        }
        
        .movie-meta {
            color: #6c757d;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .movie-overview {
            color: #495057;
            line-height: 1.6;
            margin-bottom: 15px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .movie-genres {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .genre-tag {
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .movie-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn-small {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-watch {
            background: #28a745;
            color: white;
        }
        
        .btn-watch:hover {
            background: #218838;
        }
        
        .btn-info {
            background: #17a2b8;
            color: white;
        }
        
        .btn-info:hover {
            background: #138496;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #6c757d;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            border: 1px solid #f5c6cb;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            border: 1px solid #c3e6cb;
        }
        
        .export-section {
            padding: 20px 40px;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .input-group {
                flex-direction: column;
            }
            
            .input-group input, .input-group select {
                min-width: auto;
            }
            
            .movie-grid {
                grid-template-columns: 1fr;
            }
            
            .stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé¨ ÏòÅÌôî Ï∂îÏ≤ú ÎåÄÏãúÎ≥¥Îìú</h1>
            <p>TMDB APIÎ•º ÌôúÏö©Ìïú ÏòÅÌôî Ï†ïÎ≥¥ Î∞è Ï∂îÏ≤ú ÏãúÏä§ÌÖú</p>
        </div>
        
        <div class="api-section">
            <div>üîë TMDB API ÌÇ§Í∞Ä ÌïÑÏöîÌï©ÎãàÎã§. <a href="https://www.themoviedb.org/settings/api" target="_blank">Ïó¨Í∏∞ÏÑú Î¨¥Î£åÎ°ú Î∞úÍ∏âÎ∞õÏúºÏÑ∏Ïöî</a></div>
            <div class="api-input">
                <input type="text" id="apiKey" placeholder="TMDB API ÌÇ§Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" value="">
                <button onclick="setAPIKey()">API ÌÇ§ ÏÑ§Ï†ï</button>
                <button onclick="loadSampleData()" class="btn-secondary">ÏÉòÌîå Îç∞Ïù¥ÌÑ∞ Î°úÎìú</button>
            </div>
        </div>
        
        <div class="controls">
            <div class="input-group">
                <input type="text" id="searchTerm" placeholder="ÏòÅÌôî Ï†úÎ™© Í≤ÄÏÉâ" onkeyup="searchMovies()">
                <select id="categoryFilter" onchange="filterMovies()">
                    <option value="">Î™®Îì† Ïπ¥ÌÖåÍ≥†Î¶¨</option>
                    <option value="popular">Ïù∏Í∏∞ ÏòÅÌôî</option>
                    <option value="top_rated">ÌèâÏ†ê ÎÜíÏùÄ ÏòÅÌôî</option>
                    <option value="upcoming">Í∞úÎ¥â ÏòàÏ†ï</option>
                    <option value="now_playing">ÌòÑÏû¨ ÏÉÅÏòÅ Ï§ë</option>
                </select>
                <select id="genreFilter" onchange="filterMovies()">
                    <option value="">Î™®Îì† Ïû•Î•¥</option>
                    <option value="28">Ïï°ÏÖò</option>
                    <option value="12">Î™®Ìóò</option>
                    <option value="16">Ïï†ÎãàÎ©îÏù¥ÏÖò</option>
                    <option value="35">ÏΩîÎØ∏Îîî</option>
                    <option value="80">Î≤îÏ£Ñ</option>
                    <option value="99">Îã§ÌÅêÎ©òÌÑ∞Î¶¨</option>
                    <option value="18">ÎìúÎùºÎßà</option>
                    <option value="10751">Í∞ÄÏ°±</option>
                    <option value="14">ÌåêÌÉÄÏßÄ</option>
                    <option value="36">Ïó≠ÏÇ¨</option>
                    <option value="27">Í≥µÌè¨</option>
                    <option value="10402">ÏùåÏïÖ</option>
                    <option value="9648">ÎØ∏Ïä§ÌÑ∞Î¶¨</option>
                    <option value="10749">Î°úÎß®Ïä§</option>
                    <option value="878">SF</option>
                    <option value="10770">TV ÏòÅÌôî</option>
                    <option value="53">Ïä§Î¶¥Îü¨</option>
                    <option value="10752">Ï†ÑÏüÅ</option>
                    <option value="37">ÏÑúÎ∂Ä</option>
                </select>
                <button class="btn btn-primary" onclick="loadPopularMovies()">Ïù∏Í∏∞ ÏòÅÌôî Î°úÎìú</button>
                <button class="btn btn-success" onclick="loadTopRatedMovies()">ÌèâÏ†ê ÎÜíÏùÄ ÏòÅÌôî</button>
            </div>
        </div>
        
        <div class="stats" id="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalMovies">0</div>
                <div class="stat-label">Ï¥ù ÏòÅÌôî Ïàò</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="avgRating">0.0</div>
                <div class="stat-label">ÌèâÍ∑† ÌèâÏ†ê</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalGenres">0</div>
                <div class="stat-label">Ïû•Î•¥ Ïàò</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="avgYear">2024</div>
                <div class="stat-label">ÌèâÍ∑† Í∞úÎ¥âÎÖÑÎèÑ</div>
            </div>
        </div>
        
        <div class="movies">
            <h2>üé≠ ÏòÅÌôî Î™©Î°ù</h2>
            <div id="movieList" class="movie-grid">
                <div class="loading">API ÌÇ§Î•º ÏÑ§Ï†ïÌïòÍ≥† "Ïù∏Í∏∞ ÏòÅÌôî Î°úÎìú" Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÏÑ∏Ïöî.</div>
            </div>
        </div>
        
        <div class="export-section">
            <button class="btn btn-primary" onclick="exportToCSV()">üìä CSV ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
            <button class="btn btn-primary" onclick="exportToJSON()">üìÑ JSON ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
            <button class="btn btn-secondary" onclick="generateRecommendations()">üéØ Ï∂îÏ≤ú ÏòÅÌôî ÏÉùÏÑ±</button>
            <button class="btn btn-secondary" onclick="clearData()">üóëÔ∏è Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî</button>
        </div>
    </div>

    <script>
        let moviesData = [];
        let filteredData = [];
        let apiKey = '';
        
        // ÏÉòÌîå ÏòÅÌôî Îç∞Ïù¥ÌÑ∞
        const sampleMovies = [
            {
                id: 550,
                title: "Fight Club",
                original_title: "Fight Club",
                overview: "A depressed man (Edward Norton) suffering from insomnia meets a strange soap salesman named Tyler Durden (Brad Pitt) and soon finds himself living in his squalid house after his perfect apartment is destroyed. The two bored men form an underground club with strict rules and fight other men who are fed up with their mundane lives. Their perfect partnership frays when Marla (Helena Bonham Carter), a fellow support group crasher, attracts Tyler's attention.",
                poster_path: "/pB8BM7pdSp6B6Ih7QZ4DrQ3PmJK.jpg",
                backdrop_path: "/52AfXWuXCHn3UjD17rBruA9f5qb.jpg",
                release_date: "1999-10-15",
                vote_average: 8.8,
                vote_count: 26280,
                popularity: 61.416,
                genre_ids: [18],
                genres: [{id: 18, name: "ÎìúÎùºÎßà"}]
            },
            {
                id: 13,
                title: "Forrest Gump",
                original_title: "Forrest Gump",
                overview: "A man with a low IQ has accomplished great things in his life and been present during significant historic events‚Äîin each case, far exceeding what anyone imagined he could do. But despite all the things he has attained, his love for the girl he met in childhood (Robin Wright) never wavered.",
                poster_path: "/arw2vcBveWOVZr6pxd9XTd1TdQa.jpg",
                backdrop_path: "/k2WyDw2NTUIWnuEs5gdm0nlQl1L.jpg",
                release_date: "1994-07-06",
                vote_average: 8.8,
                vote_count: 24523,
                popularity: 61.416,
                genre_ids: [35, 18],
                genres: [{id: 35, name: "ÏΩîÎØ∏Îîî"}, {id: 18, name: "ÎìúÎùºÎßà"}]
            },
            {
                id: 238,
                title: "The Godfather",
                original_title: "The Godfather",
                overview: "Spanning the years 1945 to 1955, a chronicle of the fictional Italian-American Corleone crime family. When organized crime family patriarch, Vito Corleone barely survives an attempt on his life, his youngest son, Michael steps in to take care of the would-be killers, launching a campaign of bloody revenge.",
                poster_path: "/3bhkrj58Vtu7enYsRolD1fZdja1.jpg",
                backdrop_path: "/tmU7GeKVybMWFButWEGl2M4GeiP.jpg",
                release_date: "1972-03-14",
                vote_average: 9.2,
                vote_count: 18820,
                popularity: 61.416,
                genre_ids: [18, 80],
                genres: [{id: 18, name: "ÎìúÎùºÎßà"}, {id: 80, name: "Î≤îÏ£Ñ"}]
            }
        ];
        
        function setAPIKey() {
            const key = document.getElementById('apiKey').value.trim();
            if (key) {
                apiKey = key;
                localStorage.setItem('tmdb_api_key', key);
                showSuccess('API ÌÇ§Í∞Ä ÏÑ§Ï†ïÎêòÏóàÏäµÎãàÎã§!');
            } else {
                showError('API ÌÇ§Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
            }
        }
        
        async function loadPopularMovies() {
            if (!apiKey) {
                showError('Î®ºÏ†Ä API ÌÇ§Î•º ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            showLoading();
            
            try {
                const url = `https://api.themoviedb.org/3/movie/popular?api_key=${apiKey}&language=ko-KR&page=1`;
                const response = await fetch(url);
                
                if (response.ok) {
                    const data = await response.json();
                    moviesData = data.results;
                    filteredData = data.results;
                    displayMovies();
                    updateStats();
                    showSuccess(`${data.results.length}Í∞úÏùò Ïù∏Í∏∞ ÏòÅÌôîÎ•º Í∞ÄÏ†∏ÏôîÏäµÎãàÎã§!`);
                } else {
                    throw new Error(`API Ìò∏Ï∂ú Ïã§Ìå®: ${response.status}`);
                }
                
            } catch (error) {
                console.error('API Ìò∏Ï∂ú Ïò§Î•ò:', error);
                showError(`API Ìò∏Ï∂úÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§: ${error.message}`);
                
                // ÏÉòÌîå Îç∞Ïù¥ÌÑ∞Î°ú ÎåÄÏ≤¥
                setTimeout(() => {
                    showSuccess('ÏÉòÌîå Îç∞Ïù¥ÌÑ∞Î•º Î°úÎìúÌï©ÎãàÎã§.');
                    loadSampleData();
                }, 2000);
            }
        }
        
        async function loadTopRatedMovies() {
            if (!apiKey) {
                showError('Î®ºÏ†Ä API ÌÇ§Î•º ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            showLoading();
            
            try {
                const url = `https://api.themoviedb.org/3/movie/top_rated?api_key=${apiKey}&language=ko-KR&page=1`;
                const response = await fetch(url);
                
                if (response.ok) {
                    const data = await response.json();
                    moviesData = data.results;
                    filteredData = data.results;
                    displayMovies();
                    updateStats();
                    showSuccess(`${data.results.length}Í∞úÏùò ÌèâÏ†ê ÎÜíÏùÄ ÏòÅÌôîÎ•º Í∞ÄÏ†∏ÏôîÏäµÎãàÎã§!`);
                } else {
                    throw new Error(`API Ìò∏Ï∂ú Ïã§Ìå®: ${response.status}`);
                }
                
            } catch (error) {
                console.error('API Ìò∏Ï∂ú Ïò§Î•ò:', error);
                showError(`API Ìò∏Ï∂úÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§: ${error.message}`);
            }
        }
        
        function loadSampleData() {
            moviesData = sampleMovies;
            filteredData = sampleMovies;
            displayMovies();
            updateStats();
            showSuccess('ÏÉòÌîå ÏòÅÌôî Îç∞Ïù¥ÌÑ∞Î•º Î°úÎìúÌñàÏäµÎãàÎã§.');
        }
        
        function displayMovies() {
            const movieList = document.getElementById('movieList');
            
            if (filteredData.length === 0) {
                movieList.innerHTML = '<div class="loading">Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.</div>';
                return;
            }
            
            movieList.innerHTML = filteredData.map(movie => {
                const posterUrl = movie.poster_path 
                    ? `https://image.tmdb.org/t/p/w500${movie.poster_path}`
                    : null;
                
                const releaseYear = movie.release_date ? movie.release_date.split('-')[0] : 'N/A';
                const genres = movie.genres || [];
                
                return `
                    <div class="movie-card">
                        <div class="movie-poster">
                            ${posterUrl ? 
                                `<img src="${posterUrl}" alt="${movie.title}" onerror="this.parentElement.innerHTML='<div class=\\'no-image\\'>üé¨<br>${movie.title}</div>'">` :
                                `<div class="no-image">üé¨<br>${movie.title}</div>`
                            }
                            <div class="movie-rating">‚≠ê ${movie.vote_average.toFixed(1)}</div>
                        </div>
                        <div class="movie-info">
                            <div class="movie-title">${movie.title}</div>
                            <div class="movie-meta">${releaseYear} ‚Ä¢ ${movie.vote_count.toLocaleString()}Î™Ö ÌèâÍ∞Ä</div>
                            <div class="movie-overview">${movie.overview || 'ÏÑ§Î™ÖÏù¥ ÏóÜÏäµÎãàÎã§.'}</div>
                            <div class="movie-genres">
                                ${genres.map(genre => `<span class="genre-tag">${genre.name}</span>`).join('')}
                            </div>
                            <div class="movie-actions">
                                <button class="btn-small btn-watch" onclick="watchMovie(${movie.id})">Î≥¥Í∏∞</button>
                                <button class="btn-small btn-info" onclick="showMovieDetails(${movie.id})">ÏÉÅÏÑ∏Ï†ïÎ≥¥</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function updateStats() {
            const totalMovies = filteredData.length;
            const avgRating = totalMovies > 0 ? 
                (filteredData.reduce((sum, movie) => sum + movie.vote_average, 0) / totalMovies).toFixed(1) : 0;
            
            const allGenres = new Set();
            filteredData.forEach(movie => {
                if (movie.genres) {
                    movie.genres.forEach(genre => allGenres.add(genre.name));
                }
            });
            
            const avgYear = totalMovies > 0 ? 
                Math.round(filteredData.reduce((sum, movie) => {
                    const year = movie.release_date ? parseInt(movie.release_date.split('-')[0]) : 2024;
                    return sum + year;
                }, 0) / totalMovies) : 2024;
            
            document.getElementById('totalMovies').textContent = totalMovies.toLocaleString();
            document.getElementById('avgRating').textContent = avgRating;
            document.getElementById('totalGenres').textContent = allGenres.size;
            document.getElementById('avgYear').textContent = avgYear;
        }
        
        function searchMovies() {
            const searchTerm = document.getElementById('searchTerm').value.toLowerCase();
            
            filteredData = moviesData.filter(movie => 
                movie.title.toLowerCase().includes(searchTerm) ||
                movie.overview.toLowerCase().includes(searchTerm)
            );
            
            displayMovies();
            updateStats();
        }
        
        function filterMovies() {
            const categoryFilter = document.getElementById('categoryFilter').value;
            const genreFilter = document.getElementById('genreFilter').value;
            
            filteredData = moviesData.filter(movie => {
                const matchesCategory = !categoryFilter || true; // Ïπ¥ÌÖåÍ≥†Î¶¨Îäî Ïù¥ÎØ∏ ÌïÑÌÑ∞ÎßÅÎê®
                const matchesGenre = !genreFilter || 
                    (movie.genres && movie.genres.some(genre => genre.id.toString() === genreFilter));
                
                return matchesCategory && matchesGenre;
            });
            
            displayMovies();
            updateStats();
        }
        
        function watchMovie(movieId) {
            const movie = moviesData.find(m => m.id === movieId);
            if (movie) {
                alert(`üé¨ "${movie.title}" ÏòÅÌôîÎ•º ÏãúÏ≤≠Ìï©ÎãàÎã§!\n\nÏã§Ï†úÎ°úÎäî ÏòÅÌôî Ïä§Ìä∏Î¶¨Î∞ç ÏÑúÎπÑÏä§Î°ú Ïó∞Í≤∞Îê©ÎãàÎã§.`);
            }
        }
        
        function showMovieDetails(movieId) {
            const movie = moviesData.find(m => m.id === movieId);
            if (movie) {
                const details = `
üé¨ ÏòÅÌôî ÏÉÅÏÑ∏Ï†ïÎ≥¥

Ï†úÎ™©: ${movie.title}
ÏõêÏ†ú: ${movie.original_title}
Í∞úÎ¥âÏùº: ${movie.release_date}
ÌèâÏ†ê: ‚≠ê ${movie.vote_average}/10 (${movie.vote_count.toLocaleString()}Î™Ö ÌèâÍ∞Ä)
Ïù∏Í∏∞ÎèÑ: ${movie.popularity}

Ï§ÑÍ±∞Î¶¨:
${movie.overview}

Ïû•Î•¥: ${movie.genres ? movie.genres.map(g => g.name).join(', ') : 'N/A'}
                `;
                alert(details);
            }
        }
        
        function exportToCSV() {
            if (filteredData.length === 0) {
                showError('ÎÇ¥Î≥¥ÎÇº Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            const headers = ['Ï†úÎ™©', 'ÏõêÏ†ú', 'Í∞úÎ¥âÏùº', 'ÌèâÏ†ê', 'ÌèâÍ∞ÄÏàò', 'Ïù∏Í∏∞ÎèÑ', 'Ï§ÑÍ±∞Î¶¨', 'Ïû•Î•¥'];
            const csvContent = [
                headers.join(','),
                ...filteredData.map(movie => [
                    `"${movie.title}"`,
                    `"${movie.original_title}"`,
                    `"${movie.release_date}"`,
                    movie.vote_average,
                    movie.vote_count,
                    movie.popularity,
                    `"${movie.overview || ''}"`,
                    `"${movie.genres ? movie.genres.map(g => g.name).join(', ') : ''}"`
                ].join(','))
            ].join('\n');
            
            downloadFile(csvContent, 'movies.csv', 'text/csv');
        }
        
        function exportToJSON() {
            if (filteredData.length === 0) {
                showError('ÎÇ¥Î≥¥ÎÇº Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            const jsonContent = JSON.stringify(filteredData, null, 2);
            downloadFile(jsonContent, 'movies.json', 'application/json');
        }
        
        function generateRecommendations() {
            if (filteredData.length === 0) {
                showError('Ï∂îÏ≤úÌï† Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            // ÌèâÏ†êÏù¥ ÎÜíÏùÄ ÏòÅÌôîÎì§ÏùÑ Ï∂îÏ≤ú
            const recommendations = filteredData
                .filter(movie => movie.vote_average >= 7.5)
                .sort((a, b) => b.vote_average - a.vote_average)
                .slice(0, 5);
            
            const recommendationText = recommendations.map((movie, index) => 
                `${index + 1}. ${movie.title} (‚≠ê ${movie.vote_average})`
            ).join('\n');
            
            alert(`üéØ Ï∂îÏ≤ú ÏòÅÌôî TOP 5\n\n${recommendationText}`);
        }
        
        function clearData() {
            moviesData = [];
            filteredData = [];
            document.getElementById('searchTerm').value = '';
            document.getElementById('categoryFilter').value = '';
            document.getElementById('genreFilter').value = '';
            document.getElementById('movieList').innerHTML = '<div class="loading">API ÌÇ§Î•º ÏÑ§Ï†ïÌïòÍ≥† "Ïù∏Í∏∞ ÏòÅÌôî Î°úÎìú" Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠ÌïòÏÑ∏Ïöî.</div>';
            updateStats();
        }
        
        function downloadFile(content, filename, contentType) {
            const blob = new Blob([content], { type: contentType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function showLoading() {
            document.getElementById('movieList').innerHTML = '<div class="loading">ÏòÅÌôî Îç∞Ïù¥ÌÑ∞Î•º Í∞ÄÏ†∏Ïò§Îäî Ï§ë...</div>';
        }
        
        function showError(message) {
            const movieList = document.getElementById('movieList');
            movieList.innerHTML = `<div class="error">${message}</div>`;
        }
        
        function showSuccess(message) {
            const movieList = document.getElementById('movieList');
            movieList.innerHTML = `<div class="success">${message}</div>`;
        }
        
        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï†ÄÏû•Îêú API ÌÇ§ Î≥µÏõê
        window.onload = function() {
            const savedApiKey = localStorage.getItem('tmdb_api_key');
            if (savedApiKey) {
                document.getElementById('apiKey').value = savedApiKey;
                apiKey = savedApiKey;
            }
        };
    </script>
</body>
</html> 